<# 
.SYNOPSIS
   Install Q-Pulse Audit Log Viewer

.DESCRIPTION
   Script to install and configure Q-Pulse Audit Log Viewer.

.EXAMPLE
   PS C:\> .\Win-Install-QP-AuditLogViewer.ps1
   Save the file to your hard drive with a .PS1 extention and run the file from an elavated PowerShell prompt.
   
.FUNCTIONALITY
   PowerShell v1+
#>
 
## Perform install of Q-Pulse Audit Log Viewer and dependencies.

&.\setup.exe /S /v"/qn"

## Pause for 2 minutes to allow install to completed.
Start-Sleep -Seconds 120

## Create Config File in "C:\Program Files (x86)\Gael Ltd\Q-Pulse Audit Log Viewer\"
$b64ConfigurationFile = 'PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiID8+DQo8Y29uZmlndXJhdGlvbj4NCgk8Y29uZmlnU2VjdGlvbnM+DQoJCTxzZWN0aW9uIG5hbWU9ImRhYWJQcm92aWRlcnMiIHR5cGU9IkdvdERvdE5ldC5BcHBsaWNhdGlvbkJsb2Nrcy5EYXRhLkRBQUJTZWN0aW9uSGFuZGxlcixHb3REb3ROZXQuQXBwbGljYXRpb25CbG9ja3MuRGF0YSIgLz4NCgkJPHNlY3Rpb24gbmFtZT0iQ29ubmVjdGlvbk1hbmFnZXJQcm92aWRlcnMiIHR5cGU9IkdhZWxRdWFsaXR5LkNvbm5lY3Rpdml0eS5NdWx0aVByb3ZpZGVyQ29uZmlnSGFuZGxlciwgQ29ubmVjdGl2aXR5LCBWZXJzaW9uPTEuMC4wLjAsQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsIiAvPg0KCQk8c2VjdGlvbiBuYW1lPSJleGNlcHRpb25NYW5hZ2VtZW50IiB0eXBlPSJNaWNyb3NvZnQuQXBwbGljYXRpb25CbG9ja3MuRXhjZXB0aW9uTWFuYWdlbWVudC5FeGNlcHRpb25NYW5hZ2VyU2VjdGlvbkhhbmRsZXIsIE1pY3Jvc29mdC5BcHBsaWNhdGlvbkJsb2Nrcy5FeGNlcHRpb25NYW5hZ2VtZW50IiAvPg0KCTwvY29uZmlnU2VjdGlvbnM+DQoJPGRhYWJQcm92aWRlcnM+DQoJCTxkYWFiUHJvdmlkZXIgYWxpYXM9IkJhY2NodXNTcWwiIGFzc2VtYmx5PSJHb3REb3ROZXQuQXBwbGljYXRpb25CbG9ja3MuRGF0YSIgdHlwZT0iR290RG90TmV0LkFwcGxpY2F0aW9uQmxvY2tzLkRhdGEuU3FsU2VydmVyIiAvPg0KCTwvZGFhYlByb3ZpZGVycz4NCgk8Q29ubmVjdGlvbk1hbmFnZXJQcm92aWRlcnM+DQoJCTxwcm92aWRlciBuYW1lPSJjb25uZWN0aW9uRGV0ZWN0aW9uU3RyYXRlZ3kiIA0KICAgICAgICAgICAgICAgZW5hYmxlZD0idHJ1ZSIgDQogICAgICAgICAgICAgICB0eXBlPSJHYWVsUXVhbGl0eS5Db25uZWN0aXZpdHkuUGluZ1dlYlNlcnZlclN0cmF0ZWd5LCBDb25uZWN0aXZpdHksIFZlcnNpb249MS4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLFB1YmxpY0tleVRva2VuPW51bGwiPg0KCQkJPHBvbGxpbmdJbnRlcnZhbD4yPC9wb2xsaW5nSW50ZXJ2YWw+DQoJCTwvcHJvdmlkZXI+DQoJPC9Db25uZWN0aW9uTWFuYWdlclByb3ZpZGVycz4NCgk8ZXhjZXB0aW9uTWFuYWdlbWVudCBtb2RlPSJvbiI+DQoJCTxwdWJsaXNoZXIgbW9kZT0ib24iIGFzc2VtYmx5PSJNaWNyb3NvZnQuQXBwbGljYXRpb25CbG9ja3MuRXhjZXB0aW9uTWFuYWdlbWVudCIgdHlwZT0iTWljcm9zb2Z0LkFwcGxpY2F0aW9uQmxvY2tzLkV4Y2VwdGlvbk1hbmFnZW1lbnQuRGVmYXVsdFB1Ymxpc2hlciIgbG9nTmFtZT0iQXBwbGljYXRpb24iIGFwcGxpY2F0aW9uTmFtZT0iUS1QdWxzZSBDbGllbnQiIC8+DQoJPC9leGNlcHRpb25NYW5hZ2VtZW50Pg0KCTxhcHBTZXR0aW5ncz4NCgkJPGFkZCBrZXk9IkF1dGhlbnRpY2F0aW9uIiB2YWx1ZT0iQ1NMQSIgLz4NCgkJPGFkZCBrZXk9IlNpbmdsZVNpZ25PbkVuYWJsZWQiIHZhbHVlPSJmYWxzZSIgLz4NCgkJPGFkZCBrZXk9IkxvY2F0aW9uIiB2YWx1ZT0iQ2xpZW50IiAvPg0KCQkNCgkJPCEtLUV4Y2VwdGlvbiBEaWFsb2cgSW5mby0tPg0KCQk8YWRkIGtleT0iU3VwcG9ydFNpdGVUZXh0IiB2YWx1ZT0iUS1QdWxzZSBTdXBwb3J0IFNpdGUiIC8+DQoJCTxhZGQga2V5PSJTdXBwb3J0U2l0ZUxpbmsiIHZhbHVlPSJodHRwOi8vd3d3LmdhZWxjb21tdW5pdHkuY29tL3N1cHBvcnQiIC8+DQoJCTxhZGQga2V5PSJTdXBwb3J0RW1haWxUZXh0IiB2YWx1ZT0ic3VwcG9ydEBnYWVscXVhbGl0eS5jb20iIC8+DQoJCTxhZGQga2V5PSJTdXBwb3J0RW1haWxMaW5rIiB2YWx1ZT0ibWFpbHRvOnN1cHBvcnRAZ2FlbHF1YWxpdHkuY29tIiAvPg0KCQk8YWRkIGtleT0iVXNlU2VydmljZSIgdmFsdWU9ImZhbHNlIj48L2FkZD4NCgkJPCEtLSBPcHRpb25hbCBQcm94eSBTZXR0aW5ncy0tPg0KCQk8YWRkIGtleT0iUHJveHlTZXJ2ZXJVUkkiIHZhbHVlPSIiIC8+DQoJCTxhZGQga2V5PSJQcm94eVNlcnZlclVzZXJuYW1lIiB2YWx1ZT0iIiAvPg0KCQk8YWRkIGtleT0iUHJveHlTZXJ2ZXJQYXNzd29yZCIgdmFsdWU9IiIgLz4NCgkJPGFkZCBrZXk9IlByb3h5U2VydmVyVXNlTG9nZ2VkT25DcmVkZW50aWFscyIgdmFsdWU9IiIgLz4NCiAgICA8YWRkIGtleT0iRGF0YVBvcnRhbFNlcnZlciIgdmFsdWU9ImdodHRwczovL3FwdWxzZS5zdXJyZXkuYWMudWsvUVB1bHNlRGF0YVBvcnRhbC9EYXRhUG9ydGFsLnJlbSIgLz4NCiAgICA8YWRkIGtleT0iQ3NsYURhdGFQb3J0YWxVcmwiIHZhbHVlPSJnaHR0cHM6Ly9xcHVsc2Uuc3VycmV5LmFjLnVrL1FQdWxzZURhdGFQb3J0YWwvUmVtb3RpbmdQb3J0YWwucmVtIiAvPg0KICAgIDxhZGQga2V5PSJDc2xhRGF0YVBvcnRhbFByb3h5IiB2YWx1ZT0iQ3NsYS5EYXRhUG9ydGFsQ2xpZW50LkdlbnVpbmVDaGFubmVsc1Byb3h5LCBDc2xhMyIvPg0KCTwvYXBwU2V0dGluZ3M+CQ0KCTxzeXN0ZW0ucnVudGltZS5yZW1vdGluZz4NCgkJPGFwcGxpY2F0aW9uPg0KCQkJPGxpZmV0aW1lDQoJCQkJbGVhc2VUaW1lPSIxSCINCgkJCQlzcG9uc29yc2hpcFRpbWVvdXQ9IjFIIg0KCQkJCXJlbmV3T25DYWxsVGltZT0iMUgiDQoJCQkJbGVhc2VNYW5hZ2VyUG9sbFRpbWU9IjFIIiAvPg0KCQkJPCEtLUN1c3RvbSBDaGFubmVsIFJlZ2lzdHJhdGlvbiAocmVxdWlyZWQpLS0+DQoJCQk8Y2hhbm5lbHM+DQoJCQkJPGNoYW5uZWwgdHlwZT0iQmVsaWtvdi5HZW51aW5lQ2hhbm5lbHMuR2VudWluZUh0dHAuR2VudWluZUh0dHBDbGllbnRDaGFubmVsLCBHZW51aW5lQ2hhbm5lbHMiDQoJCQkJCU1heENvbnRlbnRTaXplPSI1MDAwMDAiDQoJCQkJCUNvbm5lY3RUaW1lb3V0PSIxMDAwMCINCgkJCQkJSW52b2NhdGlvblRpbWVvdXQ9IjQ1MDAwIg0KCQkJCQlDb21wcmVzc2lvbj0idHJ1ZSINCgkJCQkJSHR0cFVzZUdsb2JhbFByb3h5PSJmYWxzZSIgLz4NCgkJCTwvY2hhbm5lbHM+DQoJCTwvYXBwbGljYXRpb24+DQoJPC9zeXN0ZW0ucnVudGltZS5yZW1vdGluZz4NCgk8cnVudGltZT4NCgkJPGdlbmVyYXRlUHVibGlzaGVyRXZpZGVuY2UgZW5hYmxlZD0iZmFsc2UiIC8+DQoJPC9ydW50aW1lPg0KPC9jb25maWd1cmF0aW9uPg0K'
$ConfigurationFile = 'C:\Program Files (x86)\Gael Ltd\Q-Pulse Audit Log Viewer\AuditLogViewer.exe.config'

$bytes = [Convert]::FromBase64String($b64ConfigurationFile)
[IO.File]::WriteAllBytes($ConfigurationFile, $bytes)

## Creates detection method. 
$path = "C:\logfiles"
If(!(test-path $path))
{
      New-Item -ItemType Directory -Force -Path $path
}

New-Item -ItemType "file" -Path "c:\logfiles\Q-Pulse-AuditLogViewer7.txt"