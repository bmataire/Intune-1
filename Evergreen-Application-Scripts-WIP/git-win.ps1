

# Decode xml config file and write output to c:\temp
$XMLConfigurationFile = 'PABDAG8AbgBmAGkAZwB1AHIAYQB0AGkAbwBuACAASQBEAD0AIgAyADAAMABlAGIANQBmADIALQA2ADIAOQBhAC0ANABhADAANQAtADgANAAyAGMALQBlAGIAYwAxAGIAMQA5ADAAMAA5ADcANwAiAD4ADQAKADwASQBuAGYAbwAgAC8APgANAAoAPABBAGQAZAAgAE8AZgBmAGkAYwBlAEMAbABpAGUAbgB0AEUAZABpAHQAaQBvAG4APQAiADYANAAiACAAQwBoAGEAbgBuAGUAbAA9ACIATQBvAG4AdABoAGwAeQBFAG4AdABlAHIAcAByAGkAcwBlACIAIABNAGkAZwByAGEAdABlAEEAcgBjAGgAPQAiAFQAUgBVAEUAIgA+AA0ACgAgACAAPABQAHIAbwBkAHUAYwB0ACAASQBEAD0AIgBPADMANgA1AFAAcgBvAFAAbAB1AHMAUgBlAHQAYQBpAGwAIgA+AA0ACgAgACAAIAAgADwATABhAG4AZwB1AGEAZwBlACAASQBEAD0AIgBlAG4ALQB1AHMAIgAgAC8APgANAAoAIAAgACAAIAA8AEUAeABjAGwAdQBkAGUAQQBwAHAAIABJAEQAPQAiAEcAcgBvAG8AdgBlACIAIAAvAD4ADQAKACAAIAAgACAAPABFAHgAYwBsAHUAZABlAEEAcABwACAASQBEAD0AIgBMAHkAbgBjACIAIAAvAD4ADQAKACAAIAAgACAAPABFAHgAYwBsAHUAZABlAEEAcABwACAASQBEAD0AIgBPAG4AZQBEAHIAaQB2AGUAIgAgAC8APgANAAoAIAAgACAAIAA8AEUAeABjAGwAdQBkAGUAQQBwAHAAIABJAEQAPQAiAEIAaQBuAGcAIgAgAC8APgANAAoAIAAgACAAIAA8AEUAeABjAGwAdQBkAGUAQQBwAHAAIABJAEQAPQAiAEIAaQBuAGcAIgAgAC8APgANAAoAIAAgADwALwBQAHIAbwBkAHUAYwB0AD4ADQAKACAAIAA8AFAAcgBvAGQAdQBjAHQAIABJAEQAPQAiAFYAaQBzAGkAbwBQAHIAbwBSAGUAdABhAGkAbAAiAD4ADQAKACAAIAAgACAAPABMAGEAbgBnAHUAYQBnAGUAIABJAEQAPQAiAGUAbgAtAHUAcwAiACAALwA+AA0ACgAgACAAIAAgADwARQB4AGMAbAB1AGQAZQBBAHAAcAAgAEkARAA9ACIARwByAG8AbwB2AGUAIgAgAC8APgANAAoAIAAgACAAIAA8AEUAeABjAGwAdQBkAGUAQQBwAHAAIABJAEQAPQAiAEwAeQBuAGMAIgAgAC8APgANAAoAIAAgACAAIAA8AEUAeABjAGwAdQBkAGUAQQBwAHAAIABJAEQAPQAiAE8AbgBlAEQAcgBpAHYAZQAiACAALwA+AA0ACgAgACAAIAAgADwARQB4AGMAbAB1AGQAZQBBAHAAcAAgAEkARAA9ACIAQgBpAG4AZwAiACAALwA+AA0ACgAgACAAIAAgADwARQB4AGMAbAB1AGQAZQBBAHAAcAAgAEkARAA9ACIAQgBpAG4AZwAiACAALwA+AA0ACgAgACAAPAAvAFAAcgBvAGQAdQBjAHQAPgANAAoAPAAvAEEAZABkAD4ADQAKADwAVQBwAGQAYQB0AGUAcwAgAEUAbgBhAGIAbABlAGQAPQAiAFQAUgBVAEUAIgAgAC8APgANAAoAPABMAG8AZwBnAGkAbgBnACAATABlAHYAZQBsAD0AIgBTAHQAYQBuAGQAYQByAGQAIgAgAFAAYQB0AGgAPQAiACUAdABlAG0AcAAlACIAIAAvAD4ADQAKADwAUgBlAG0AbwB2AGUATQBTAEkAIAAvAD4ADQAKADwAQQBwAHAAUwBlAHQAdABpAG4AZwBzAD4ADQAKACAAIAA8AFMAZQB0AHUAcAAgAE4AYQBtAGUAPQAiAEMAbwBtAHAAYQBuAHkAIgAgAFYAYQBsAHUAZQA9ACIAVQBuAGkAdgBlAHIAcwBpAHQAeQAgAG8AZgAgAFMAdQByAHIAZQB5ACIAIAAvAD4ADQAKACAAIAA8AFUAcwBlAHIAIABLAGUAeQA9ACIAcwBvAGYAdAB3AGEAcgBlAFwAbQBpAGMAcgBvAHMAbwBmAHQAXABvAGYAZgBpAGMAZQBcADEANgAuADAAXABlAHgAYwBlAGwAXABvAHAAdABpAG8AbgBzACIAIABOAGEAbQBlAD0AIgBkAGUAZgBhAHUAbAB0AGYAbwByAG0AYQB0ACIAIABWAGEAbAB1AGUAPQAiADUAMQAiACAAVAB5AHAAZQA9ACIAUgBFAEcAXwBEAFcATwBSAEQAIgAgAEEAcABwAD0AIgBlAHgAYwBlAGwAMQA2ACIAIABJAGQAPQAiAEwAXwBTAGEAdgBlAEUAeABjAGUAbABmAGkAbABlAHMAYQBzACIAIAAvAD4ADQAKACAAIAA8AFUAcwBlAHIAIABLAGUAeQA9ACIAcwBvAGYAdAB3AGEAcgBlAFwAbQBpAGMAcgBvAHMAbwBmAHQAXABvAGYAZgBpAGMAZQBcADEANgAuADAAXABwAG8AdwBlAHIAcABvAGkAbgB0AFwAbwBwAHQAaQBvAG4AcwAiACAATgBhAG0AZQA9ACIAZABlAGYAYQB1AGwAdABmAG8AcgBtAGEAdAAiACAAVgBhAGwAdQBlAD0AIgAyADcAIgAgAFQAeQBwAGUAPQAiAFIARQBHAF8ARABXAE8AUgBEACIAIABBAHAAcAA9ACIAcABwAHQAMQA2ACIAIABJAGQAPQAiAEwAXwBTAGEAdgBlAFAAbwB3AGUAcgBQAG8AaQBuAHQAZgBpAGwAZQBzAGEAcwAiACAALwA+AA0ACgAgACAAPABVAHMAZQByACAASwBlAHkAPQAiAHMAbwBmAHQAdwBhAHIAZQBcAG0AaQBjAHIAbwBzAG8AZgB0AFwAbwBmAGYAaQBjAGUAXAAxADYALgAwAFwAdwBvAHIAZABcAG8AcAB0AGkAbwBuAHMAIgAgAE4AYQBtAGUAPQAiAGQAZQBmAGEAdQBsAHQAZgBvAHIAbQBhAHQAIgAgAFYAYQBsAHUAZQA9ACIAIgAgAFQAeQBwAGUAPQAiAFIARQBHAF8AUwBaACIAIABBAHAAcAA9ACIAdwBvAHIAZAAxADYAIgAgAEkAZAA9ACIATABfAFMAYQB2AGUAVwBvAHIAZABmAGkAbABlAHMAYQBzACIAIAAvAD4ADQAKADwALwBBAHAAcABTAGUAdAB0AGkAbgBnAHMAPgANAAoAPABEAGkAcwBwAGwAYQB5ACAATABlAHYAZQBsAD0AIgBOAG8AbgBlACIAIABBAGMAYwBlAHAAdABFAFUATABBAD0AIgBUAFIAVQBFACIAIAAvAD4ADQAKADwAUAByAG8AcABlAHIAdAB5ACAATgBhAG0AZQA9ACIARgBPAFIAQwBFAEEAUABQAFMASABVAFQARABPAFcATgAiACAAVgBhAGwAdQBlAD0AIgBUAFIAVQBFACIALwA+AA0ACgA8AC8AQwBvAG4AZgBpAGcAdQByAGEAdABpAG8AbgA+AA=='
$DECODED = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($XMLConfigurationFile)) 
Write-Output $DECODED | Out-File "C:\temp\install.inf" -NoClobber

# get latest download url for git-for-windows 64-bit exe
$git_url = "https://api.github.com/repos/git-for-windows/git/releases/latest"
$asset = Invoke-RestMethod -Method Get -Uri $git_url | ForEach-Object assets | Where-Object name -like "*64-bit.exe"
# download installer
$installer = "$env:temp\$($asset.name)"
Invoke-WebRequest -Uri $asset.browser_download_url -OutFile $installer
# run installer
$git_install_inf = "<install inf file>"
$install_args = "/SP- /VERYSILENT /SUPPRESSMSGBOXES /NOCANCEL /NORESTART /CLOSEAPPLICATIONS /RESTARTAPPLICATIONS /LOADINF=""$git_install_inf"""
Start-Process -FilePath $installer -ArgumentList $install_args -Wait